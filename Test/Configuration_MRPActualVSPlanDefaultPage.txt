*** Settings ***
Resource          Resource/PageKeywords/Configuration_MRPActualVSPlanDefaultPage.txt
Resource          Resource/PageKeywords/SCGPeMRPCommon.txt

*** Test Cases ***
64_Create Default Page Select Tier 3 And All Type
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    MRPActualVSPlanningDefaultPage
    ${name}    Create Default Page Data Tier3 All Type
    Verify Create Tier 3 All Type    ${name}
    [Teardown]    Keywords For Teardown

65_Create Default Page Select Tier 3 And Import Type
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    MRPActualVSPlanningDefaultPage
    Create Default Page Data Tier3 Import Type
    [Teardown]    Keywords For Teardown

66_Create Default Page Select Tier 3 And Domestic Type
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    MRPActualVSPlanningDefaultPage
    Create Default Page Data Tier3 Domestic Type
    [Teardown]    Keywords For Teardown

67_Create Default Page Select Tier 4 And All Type
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    MRPActualVSPlanningDefaultPage
    [Teardown]    Keywords For Teardown

68_Create Default Page Select Tier 5 And All Type
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    MRPActualVSPlanningDefaultPage
    [Teardown]    Keywords For Teardown

69_Create Default Page In Case Not Select Material Tier 1
    [Documentation]    ***Condition***
    ...
    ...    ***Test Step***
    ...    1.Open SCG website
    ...    2.Select "Configuration"
    ...    3.Select "MRP Actual VS Plan Default Page"
    ...    4. Click search
    ...    5. Verify Alert message "Please select material tier one."
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    MRPActualVSPlanningDefaultPage
    Select Material Tier1
    #Not Select Material Tier 1
    Search Create Default Page
    Verify Message Not Select Tier 1
    [Teardown]    Keywords For Teardown

70_Create Default Page In Case Not Select Material Tier 2
    [Documentation]    ***Condition***
    ...
    ...    ***Test Step***
    ...    1.Open SCG website
    ...    2.Select "Configuration"
    ...    3.Select "MRP Actual VS Plan Default Page"
    ...    4. Select Material Tier 1
    ...    5. Click search
    ...    6. Verify Alert message "Please select material tier two."
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    MRPActualVSPlanningDefaultPage
    Select Material Tier1
    #Not Select Material Tier 2
    Search Create Default Page
    Verify Message Not Select Tier 2
    [Teardown]    Keywords For Teardown

71_Create Default Page In Case Not Select Lists of Material
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    MRPActualVSPlanningDefaultPage
    Select Material Tier1
    Select Material Tier2
    Search Create Default Page
    #Not Select Material
    Save Create Default
    [Teardown]    Keywords For Teardown

72_Clear Search Create Default Page
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    MRPActualVSPlanningDefaultPage
    [Teardown]    Keywords For Teardown

73_Save As Link To Plant Page
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    MRPActualVSPlanningDefaultPage
    [Teardown]    Keywords For Teardown

74_Search Result Material Tier 2
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    MRPActualVSPlanningDefaultPage
    [Teardown]    Keywords For Teardown

75_Edit Result Material Tier 2
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    MRPActualVSPlanningDefaultPage
    [Teardown]    Keywords For Teardown

76_Search View Material Tier
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    MRPActualVSPlanningDefaultPage
    [Teardown]    Keywords For Teardown

77_Preview Result Material Tier
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    MRPActualVSPlanningDefaultPage
    [Teardown]    Keywords For Teardown

78_Delete Result Material Tier 2
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    MRPActualVSPlanningDefaultPage
    [Teardown]    Keywords For Teardown

*** Keywords ***
Create Default Page Data Tier3 All Type
    Select Material Tier1
    Select Material Tier2
    Search Create Default Page
    Select First Material Tier Create Default Page
    Save Create Default

Create Default Page Data Tier3 Import Type
    Select Material Tier1
    Select Material Tier2
    Select Type    Import
    Search Create Default Page

Create Default Page Data Tier3 Domestic Type
    Select Material Tier1
    Select Material Tier2
    Select Type    Domestic
    Search Create Default Page

Create Default Page Data Tier3 Import Type
    select material tier1
    select material tier2
    select type    Import
    click search create default page
    select first material tier create default page
    click save create default

Create Default Page Data Tier3 Domestic Type
    select material tier1
    select material tier2
    select type    Domestic
    click search create default page
    select first material tier create default page
    click save create default

Verify Create Tier 3 All Type
    [Arguments]    ${name}
    Web Element Text Should Be    ${txtMessageSaveDefault}    ${txtMessageSaveDefaultPage}
    Click Web Element    ${btnDismissMessageSaveDefault}
    ${count}    Get Matching Xpath Count    //*[@id="gridMaterialTierTwoDefaultPage"]/table/tbody/tr/td[1]
    :FOR    ${index}    IN RANGE    1    ${count}
    \    ${tiername}    Get Web Text    xpath=//*[@id="gridMaterialTierTwoDefaultPage"]/table/tbody/tr[${index}]/td[1]
    \    Run Keyword If    "${tiername}" == "${name}"    Exit For Loop
    ${total}    Evaluate    ${index}+1
    Web Element Text Should Be    xpath=//*[@id="gridMaterialTierTwoDefaultPage"]/table/tbody/tr[${total}]/td[1]    ${name}
    Capture ScreenShot

Verify Create Tier 3 Import Type
    [Arguments]    ${name}
    Web Element Text Should Be    ${txtMessageSaveDefault}    ${txtMessageSaveDefaultPage}
    Click Web Element    ${btnDismissMessageSaveDefault}
    ${count}    Get Matching Xpath Count    //*[@id="gridMaterialTierTwoDefaultPage"]/table/tbody/tr/td[1]
    :FOR    ${index}    IN RANGE    1    ${count}
    \    ${tiername}    Get Web Text    xpath=//*[@id="gridMaterialTierTwoDefaultPage"]/table/tbody/tr[${index}]/td[1]
    \    Run Keyword If    "${tiername}" == "${name}"    Exit For Loop
    ${total}    Evaluate    ${index}+1
    Web Element Text Should Be    xpath=//*[@id="gridMaterialTierTwoDefaultPage"]/table/tbody/tr[${total}]/td[1]    ${name}
    select material tier1
    ${name}    select material tier2
    click search create default page
    select first material tier create default page
    click save create default
    [Return]    ${name}

Verify Message Not Select Tier 1
    Web Element Text Should Be    ${modaltxtAlertMssage}    ${txtMessageNotSelectTier1}
    Capture ScreenShot

Verify Message Not Select Tier 2
    Web Element Text Should Be    ${modaltxtAlertMssage}    ${txtMessageNotSelectTier2}
    Capture ScreenShot
