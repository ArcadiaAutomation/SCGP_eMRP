*** Settings ***
Resource          Resource/PageKeywords/Configuration_PlantNameAndPM.txt
Resource          Resource/PageKeywords/SCGPeMRPCommon.txt

*** Test Cases ***
1_Create a company which contain multiple plants
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Company Tab
    Click Add Company Record
    Fill Company Data
    Click Company Update
    Verify Create Company Success
    [Teardown]    Keywords For Teardown

2_Create a company which contain multiple plants in case no code
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Company Tab
    Click Add Company Record
    Fill Company Data No Code
    Click Company Update
    Verify Message Company No Code
    [Teardown]    Keywords For Teardown

3_Create a company which contain multiple plants in case no name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Company Tab
    Click Add Company Record
    Fill Company Data No Name
    Click Company Update
    Verify Message Company No Name
    [Teardown]    Keywords For Teardown

4_Create a company which contain multiple plants in case duplicate name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Click Add Company Record
    [Teardown]    Keywords For Teardown

5_Edit a company to change the company name and plant list
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Company Tab
    [Teardown]    Keywords For Teardown

6_Delete a company and its associated list of plants
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Company Tab
    [Teardown]    Keywords For Teardown

7_Create a business group which it can contain multiple companies
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Click Add Business Group
    [Teardown]    Keywords For Teardown

8_Create a business group which it can contain multiple companies in case no name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    [Teardown]    Keywords For Teardown

9_Create a business group which it can contain multiple companies in case duplicate name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    [Teardown]    Keywords For Teardown

10_Edit business group name and the list of companies inside
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    [Teardown]    Keywords For Teardown

11_Delete a business group and its associated list of companies
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    [Teardown]    Keywords For Teardown

12_Create a plant which it can contain multiple machines
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    [Teardown]    Keywords For Teardown

13_Create a plant which it can contain multiple location
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    [Teardown]    Keywords For Teardown

14_Create a plant which it can contain multiple machines and location
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    [Teardown]    Keywords For Teardown

15_Create a plant in case no code
    [Documentation]    ***Condition***
    ...
    ...    ***Test Step***
    ...    1.Open SCG website
    ...    2.Select "Configuration"
    ...    3.Select "Plant name & PM"
    ...    4.Select "Plant" Tab
    ...    5. Add new record
    ...    6. Input information (Empty Code)
    ...    7. Update
    ...    8. Verify Alert massage: Plant Code is required
    [Tags]    Fail
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    SettingPlant
    Select Plant Tab
    Click Add Plant
    fill code    Plant    ${EMPTY}
    fill name    Plant    Korat
    [Teardown]    Keywords For Teardown

16_Create a plant in case no name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    SettingPlant

17_Create a plant in case duplicate name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    [Teardown]    Keywords For Teardown

16_Create a plant in case no name

17_Create a plant in case duplicate name

18_Edit a plant to change name and the list of machines and locations inside

19_Delete a company and its associated list of machines and locations

20_Create a machine

21_Create a machine in case no code

22_Create a machine in case no name

23_Create a machine in case duplicate name

24_Edit a machine

25_Delete a machine

26_Create a location

27_Create a location in case no name

28_Create a location in case no capacity

29_Edit a location

30_Delete a location

*** Keywords ***
Select Business Group Tab
    select tab    BusinessGroup

Select Company Tab
    select tab    Company

Select Plant Tab
    select tab    Plant

Select Machine Tab
    select tab    Machine

Select Location Tab
    select tab    Location

Verify alert text no code
    Page Should Contain Element    ${txtMessageCompanyNoCode}    ${txtCompanyNoCode}
    Capture ScreenShot

Click Add Company Record
    click add record    Company

Click Add Business Group
    click add record    BusinessGroup

Click Add Plant
    click add record    Plant

Click Add Machine
    click add record    Machine

Click Add Location
    click add record    Location

Fill Company Data
    fill code    Company    ${txtCode}
    fill name    Company    ${txtName}
    Select company plant

Select company plant
    click ddl    Plant
    select first choice    Plant

Click Company Update
    click update button    Company

Fill Company Data No Code
    fill name    Company    ${txtName}
    Select company plant

Verify Create Company Success
    refresh page
    Sleep    2
    : FOR    ${index}    IN RANGE    1    11
    \    Wait Until Page Contains Element    xpath=//*[@id="gridCompany"]/div[3]/table/tbody/tr[${index}]/td[1]
    \    ${text}    Get Text    xpath=//*[@id="gridCompany"]/div[3]/table/tbody/tr[${index}]/td[1]
    \    log    ${text}
    \    Run Keyword If    "${text}" == "${txtCode}" ||    Exit For Loop
    Capture ScreenShot
    delete record    ${index}

Click company next page
    click next page    Company

Verify Message Company No Code
    Wait Until Page Contains Element    ${txtMessageCompanyNoCode}
    Element Text Should Be    ${txtMessageCompanyNoCode}    ${txtCompanyNoCode}
    Capture ScreenShot

Fill Company Data No Name
    fill code    Company    ${txtCode}
    Select company plant

Verify Message Company No Name
    Wait Until Page Contains Element    ${txtMessageCompanyNoName}
    Element Text Should Be    ${txtMessageCompanyNoName}    ${txtCompanyNoName}
    Capture ScreenShot

Fill Business Group Data
    fill name    BusinessGroup    ${txtName}
