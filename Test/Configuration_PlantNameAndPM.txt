*** Settings ***
Resource          Resource/PageKeywords/Configuration_PlantNameAndPM.txt
Resource          Resource/PageKeywords/SCGPeMRPCommon.txt

*** Test Cases ***
1_Create a company which contain multiple plants
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Company Tab
    Click Add Company Record
    Fill Company Data
    Click Company Update
    Verify Create Company Success
    [Teardown]    Keywords For Teardown

2_Create a company which contain multiple plants in case no code
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Company Tab
    Click Add Company Record
    Fill Company Data No Code
    Click Company Update
    Verify Message Company No Code
    [Teardown]    Keywords For Teardown

3_Create a company which contain multiple plants in case no name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Company Tab
    Click Add Company Record
    Fill Company Data No Name
    Click Company Update
    Verify Message Company No Name
    [Teardown]    Keywords For Teardown

4_Create a company which contain multiple plants in case duplicate name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Click Add Company Record
    [Teardown]    Keywords For Teardown

5_Edit a company to change the company name and plant list
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Company Tab
    Edit Company Data
    Click Company Update
    Verify Company Edit
    [Teardown]    Keywords For Teardown

6_Delete a company and its associated list of plants
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Company Tab
    Delete Company First Row
    Verify Delete Company
    [Teardown]    Keywords For Teardown

7_Create a business group which it can contain multiple companies
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Business Group Tab
    Click Add Business Group
    Fill Business Group Data
    Click Update Business Group
    Verify Create Business Group Success
    [Teardown]    Keywords For Teardown

8_Create a business group which it can contain multiple companies in case no name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Business Group Tab
    Click Add Business Group
    Fill Business Group Data No Name
    Click Update Business Group
    Verify Message Business Group No Name
    [Teardown]    Keywords For Teardown

9_Create a business group which it can contain multiple companies in case duplicate name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Click Add Business Group
    [Teardown]    Keywords For Teardown

10_Edit business group name and the list of companies inside
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Business Group Tab
    Edit Business Group Data
    Click Update Business Group
    Verify Business Group Edit
    [Teardown]    Keywords For Teardown

11_Delete a business group and its associated list of companies
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Business Group Tab
    Delete Business First Row
    Verify Business Group Delete
    [Teardown]    Keywords For Teardown

12_Create a plant which it can contain multiple machines
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Plant Tab
    Click Add Plant
    Fill Plant Data With Multiple Machine
    Click Update Plant
    [Teardown]    Keywords For Teardown

13_Create a plant which it can contain multiple location
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Plant Tab
    select machine
    select multiple location
    [Teardown]    Keywords For Teardown

14_Create a plant which it can contain multiple machines and location
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Plant Tab
    [Teardown]    Keywords For Teardown

15_Create a plant in case no code
    [Documentation]    ***Condition***
    ...
    ...    ***Test Step***
    ...    1.Open SCG website
    ...    2.Select "Configuration"
    ...    3.Select "Plant name & PM"
    ...    4.Select "Plant" Tab
    ...    5. Add new record
    ...    6. Input information (Empty Code)
    ...    7. Update
    ...    8. Verify Alert massage: Plant Code is required
    [Tags]    Fail
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Plant Tab
    Click Add Plant
    click update button    Plant
    fill code    Plant    ${EMPTY}
    fill name    Plant    Korat
    select machine
    select location
    Click Update Plant
    Verify Massage Plant No Code
    [Teardown]    Keywords For Teardown

16_Create a plant in case no name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Plant Tab

17_Create a plant in case duplicate name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Plant Tab
    [Teardown]    Keywords For Teardown

18_Edit a plant to change name and the list of machines and locations inside
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Plant Tab

19_Delete a Plant and its associated list of machines and locations
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Plant Tab

20_Create a machine
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Machine Tab

21_Create a machine in case no code
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Machine Tab

22_Create a machine in case no name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Machine Tab

23_Create a machine in case duplicate name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Machine Tab

24_Edit a machine
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Machine Tab

25_Delete a machine
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Machine Tab

26_Create a location
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Location Tab

27_Create a location in case no name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Location Tab

28_Create a location in case no capacity
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Location Tab

29_Edit a location
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Location Tab

30_Delete a location
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Location Tab

*** Keywords ***
Select Business Group Tab
    select tab    BusinessGroup

Select Company Tab
    select tab    Company

Select Plant Tab
    Comment    select tab    Plant
    Click Web Element    ${tabBtnPlant}

Select Machine Tab
    select tab    Machine

Select Location Tab
    select tab    Location

Verify alert text no code
    Page Should Contain Element    ${txtMessageCompanyNoCode}    ${txtCompanyNoCode}
    Capture ScreenShot

Click Add Company Record
    click add record    Company

Click Add Business Group
    click add record    BusinessGroup

Click Add Plant
    click add record    Plant

Click Add Machine
    click add record    Machine

Click Add Location
    click add record    Location

Fill Company Data
    fill code    Company    ${txtCode}
    fill name    Company    ${txtName}
    Select company plant

Select company plant
    click ddl    Plant
    select ddl first choice    Plant
    click ddl    Plant
    select ddl second choice    Plant

Click Company Update
    click update button    Company

Fill Company Data No Code
    fill name    Company    ${txtName}
    Select company plant

Verify Create Company Success
    refresh page    Company
    Sleep    2
    : FOR    ${index}    IN RANGE    1    11
    \    Wait Until Page Contains Element    xpath=//*[@id="gridCompany"]/div[3]/table/tbody/tr[${index}]/td[1]
    \    ${code}    Get Text    xpath=//*[@id="gridCompany"]/div[3]/table/tbody/tr[${index}]/td[1]
    \    ${name}    Get Text    xpath=//*[@id="gridCompany"]/div[3]/table/tbody/tr[${index}]/td[2]
    \    log    ${code}
    \    Run Keyword If    "${code}" == "${txtCode}"    Run Keyword If    "${name}" == "${txtName}"    Exit For Loop
    Capture ScreenShot
    delete record    ${index}

Click company next page
    click next page    Company

Verify Message Company No Code
    Wait Until Page Contains Element    ${txtMessageCompanyNoCode}
    Element Text Should Be    ${txtMessageCompanyNoCode}    ${txtCompanyNoCode}
    Capture ScreenShot

Fill Company Data No Name
    fill code    Company    ${txtCode}
    Select company plant

Verify Message Company No Name
    Wait Until Page Contains Element    ${txtMessageCompanyNoName}
    Element Text Should Be    ${txtMessageCompanyNoName}    ${txtCompanyNoName}
    Capture ScreenShot

Fill Business Group Data
    fill name    BusinessGroup    ${txtName}
    Select Company

Delete Business First Row
    ${name}    Get Text    ${lblCompanyNameFirstRow}
    delete first row    Business
    [Return]    ${name}

Delete Company First Row
    ${name}=    Get Web Text    xpath=//*[@id="gridCompany"]/div[3]/table/tbody/tr[1]/td[2]
    delete first row    Company
    [Return]    ${name}

Delete Plant First Row
    delete first row    Plant

Delete Machine First Row
    delete first row    Machine

Delete Location First Row
    delete first row    Location

Select Company
    click ddl    Company
    select ddl first choice    Company
    click ddl    Company
    select ddl second choice    Company

Click Update Business Group
    click update button    BusinessGroup

Verify Create Business Group Success
    refresh page    BusinessGroup
    Sleep    2
    : FOR    ${index}    IN RANGE    1    11
    \    Wait Until Page Contains Element    xpath= //*[@id="gridBusinessGroup"]/div[3]/table/tbody/tr[${index}]/td[1]
    \    ${name}    Get Text    xpath= //*[@id="gridBusinessGroup"]/div[3]/table/tbody/tr[${index}]/td[1]
    \    log    ${name}
    \    Run Keyword If    "${name}" == "${txtName}"    Exit For Loop
    Capture ScreenShot

Fill Business Group Data No Name
    Select Company

Verify Message Business Group No Name
    Wait Until Page Contains Element    ${txtMessageBusinessGroupNoName}
    Element Text Should Be    ${txtMessageBusinessGroupNoName}    ${txtBusinessGroupNoName}
    Capture ScreenShot

Edit Company Data
    edit name    Company
    sleep    3
    Edit company plant

delete list
    [Arguments]    ${Text}
    Run Keyword If    "${Text}" == "Company"    Click Web Element    xpath=//*[@id="Plants_taglist"]/li/span[2]/span
    Run Keyword If    "${Text}" == "BusinessGroup"    Click Web Element    xpath=//*[@id="Companies_taglist"]/li/span[2]/span
    Run Keyword If    "${Text}" == "Plant"    Click Web Element    xpath=//*[@id="Plants_taglist"]/li/span[2]/span
    Run Keyword If    "${Text}" == "Machine"    Click Web Element    xpath=//*[@id="Plants_taglist"]/li/span[2]/span
    Run Keyword If    "${Text}" == "Location"    Click Web Element    xpath=//*[@id="Plants_taglist"]/li/span[2]/span

Edit company plant
    click edit button    Company
    delete list    Company
    click ddl    Plant
    select ddl third choice    Plant

Verify Company Edit
    Wait Until Page Contains Element    ${lblCompanyNameFirstRow}
    Page Should Contain Element    ${lblCompanyNameFirstRow}
    sleep    2
    Capture ScreenShot

Verify Delete Company
    Element Should Not Contain    ${lblCompanyNameFirstRow}
    Capture ScreenShot

Edit Business Group Data
    edit name    BusinessGroup
    sleep    2
    Edit business group company

Edit business group company
    click edit button    Business Group
    delete list    BusinessGroup
    click ddl    Company
    select ddl third choice    Company

Verify Business Group Edit
    Wait Until Page Contains Element    ${lblBusinessGroupNameFirstRow}
    Page Should Contain Element    ${lblBusinessGroupNameFirstRow}
    sleep    2
    Capture ScreenShot

Verify Business Group Delete
    ${name}    Delete Business First Row
    Element Should Not Contain    ${lblBusinessGroupNameFirstRow}    ${name}
    Capture ScreenShot

Fill Plant Data With Multiple Machine
    fill code    Plant    ${txtPlantCode}
    fill name    Plant    ${txtPlantName}
    select multiple machine
    select location

select machine
    click ddl    Machine
    select ddl first choice    Machine

select location
    click ddl    Location
    select ddl first choice    Location

select multiple machine
    click ddl    Machine
    select ddl first choice    Machine
    click ddl    Machine
    select ddl second choice    Machine

select multiple location
    click ddl    Location
    select ddl first choice    Location
    click ddl    Location
    select ddl second choice    Location

Click Update Plant
    click update button    Plant

Verify Massage Plant No Code
    Web Element Text Should Be    xpath=//*[@id="txtPlantCode_validationMessage"]    Plant Code is required
    Capture ScreenShot
