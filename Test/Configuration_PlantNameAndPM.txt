*** Settings ***
Resource          Resource/PageKeywords/Configuration_PlantNameAndPM.txt
Resource          Resource/PageKeywords/SCGPeMRPCommon.txt

*** Variables ***

*** Test Cases ***
1_Create a company which contain multiple plants
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Company
    Click Add Record    Company
    Fill Company Data
    Click Update Button    Company
    Verify Create Company Success
    [Teardown]    Keywords For Teardown

2_Create a company which contain multiple plants in case no code
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Company
    Click Add Record    Company
    Fill Company Data No Code
    Click Update Button    Company
    Verify Message Company No Code
    [Teardown]    Keywords For Teardown

3_Create a company which contain multiple plants in case no name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Company
    Click Add Record    Company
    Fill Company Data No Name
    Click Update Button    Company
    Verify Message Company No Name
    [Teardown]    Keywords For Teardown

4_Create a company which contain multiple plants in case duplicate name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Company
    Click Add Record    Company
    [Teardown]    Keywords For Teardown

5_Edit a company to change the company name and plant list
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Company
    Edit Company Data
    Click Update Button    Company
    Verify Company Edit
    [Teardown]    Keywords For Teardown

6_Delete a company and its associated list of plants
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Company
    ${name}    Delete First Row    Company
    Verify Delete Company    ${name}
    [Teardown]    Keywords For Teardown

7_Create a business group which it can contain multiple companies
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    BusinessGroup
    Click Add Record    BusinessGroup
    Fill Business Group Data
    Click Update Button    BusinessGroup
    Verify Create Business Group Success
    [Teardown]    Keywords For Teardown

8_Create a business group which it can contain multiple companies in case no name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    BusinessGroup
    Click Add Record    BusinessGroup
    Fill Business Group Data No Name
    Click Update Button    BusinessGroup
    Verify Message Business Group No Name
    [Teardown]    Keywords For Teardown

9_Create a business group which it can contain multiple companies in case duplicate name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    BusinessGroup
    Click Add Record    BusinessGroup
    [Teardown]    Keywords For Teardown

10_Edit business group name and the list of companies inside
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    BusinessGroup
    Edit Business Group Data
    Click Update Button    BusinessGroup
    Verify Business Group Edit
    [Teardown]    Keywords For Teardown

11_Delete a business group and its associated list of companies
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    BusinessGroup
    ${name}    Delete First Row    BusinessGroup
    Verify Business Group Delete    ${name}
    [Teardown]    Keywords For Teardown

12_Create a plant which it can contain multiple machines
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Plant
    Click Add Record    Plant
    Fill Plant Data With Multiple Machine
    Click Update Button    Plant
    [Teardown]    Keywords For Teardown

13_Create a plant which it can contain multiple location
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Plant
    Click Add Record    Plant
    Fill Plant Data With Multiple Location
    Click Update Button    Plant
    [Teardown]    Keywords For Teardown

14_Create a plant which it can contain multiple machines and location
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Plant
    Click Add Record    Plant
    Fill Plant Data With Multiple Machines And Locations
    Click Update Button    Plant
    [Teardown]    Keywords For Teardown

15_Create a plant in case no code
    [Documentation]    ***Condition***
    ...
    ...    ***Test Step***
    ...    1.Open SCG website
    ...    2.Select "Configuration"
    ...    3.Select "Plant name & PM"
    ...    4.Select "Plant" Tab
    ...    5. Add new record
    ...    6. Input information (Empty Code)
    ...    7. Update
    ...    8. Verify Alert massage: Plant Code is required
    [Tags]    Fail
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Plant
    Click Add Record    Plant
    Fill Plant Data No Code
    Verify Massage Plant No Code
    [Teardown]    Keywords For Teardown

16_Create a plant in case no name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Plant
    Click Add Record    Plant
    Fill Plant Data No Name
    Verify Massage Plant No Name
    [Teardown]    Keywords For Teardown

17_Create a plant in case duplicate name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Plant
    Click Add Record    Plant
    [Teardown]    Keywords For Teardown

18_Edit a plant to change name and the list of machines and locations inside
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Plant

19_Delete a Plant and its associated list of machines and locations
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Plant

20_Create a machine
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Machine

21_Create a machine in case no code
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Machine

22_Create a machine in case no name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Machine

23_Create a machine in case duplicate name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Machine

24_Edit a machine
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Machine

25_Delete a machine
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Machine

26_Create a location
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Location

27_Create a location in case no name
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Location

28_Create a location in case no capacity
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Location

29_Edit a location
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Location

30_Delete a location
    Open SCG Website
    Select Menu    Configuration
    Select Sub Menu    PlantNameAndPM
    Select Tab    Location

*** Keywords ***
Select Business Group Tab
    select tab    BusinessGroup

Select Company Tab
    select tab    Company

Select Plant Tab
    Comment    select tab    Plant
    Click Web Element    ${tabBtnPlant}

Select Machine Tab
    select tab    Machine

Select Location Tab
    select tab    Location

Verify alert text no code
    Page Should Contain Element    ${txtMessageCompanyNoCode}    ${txtCompanyNoCode}
    Capture ScreenShot

Fill Company Data
    Fill Code    Company    ${txtCode}
    Fill Name    Company    ${txtName}
    Select ddl    Plant    1    1

Fill Company Data No Code
    Fill Name    Company    ${txtName}
    Select ddl    Plant    1    1

Verify Create Company Success
    refresh page    Company
    Sleep    2
    : FOR    ${index}    IN RANGE    1    11
    \    Wait Until Page Contains Element    xpath=//*[@id="gridCompany"]/div[3]/table/tbody/tr[${index}]/td[1]
    \    ${code}    Get Text    xpath=//*[@id="gridCompany"]/div[3]/table/tbody/tr[${index}]/td[1]
    \    ${name}    Get Text    xpath=//*[@id="gridCompany"]/div[3]/table/tbody/tr[${index}]/td[2]
    \    log    ${code}
    \    Run Keyword If    "${code}" == "${txtCode}"    Run Keyword If    "${name}" == "${txtName}"    Exit For Loop
    Capture ScreenShot

Click company next page
    click next page    Company

Verify Message Company No Code
    Wait Until Page Contains Element    ${txtMessageCompanyNoCode}
    Element Text Should Be    ${txtMessageCompanyNoCode}    ${txtCompanyNoCode}
    Capture ScreenShot

Fill Company Data No Name
    Fill Code    Company    ${txtCode}
    Select ddl    Plant    1    1

Verify Message Company No Name
    Wait Until Page Contains Element    ${txtMessageCompanyNoName}
    Element Text Should Be    ${txtMessageCompanyNoName}    ${txtCompanyNoName}
    Capture ScreenShot

Fill Business Group Data
    Fill Name    BusinessGroup    ${txtName}
    Select Company

Select Company
    click ddl    Company
    Select ddl    Company    1    2

Verify Create Business Group Success
    refresh page    BusinessGroup
    Sleep    2
    : FOR    ${index}    IN RANGE    1    11
    \    Wait Until Page Contains Element    xpath= //*[@id="gridBusinessGroup"]/div[3]/table/tbody/tr[${index}]/td[1]
    \    ${name}    Get Text    xpath= //*[@id="gridBusinessGroup"]/div[3]/table/tbody/tr[${index}]/td[1]
    \    log    ${name}
    \    Run Keyword If    "${name}" == "${txtName}"    Exit For Loop
    Capture ScreenShot

Fill Business Group Data No Name
    Select Company

Verify Message Business Group No Name
    Wait Until Page Contains Element    ${txtMessageBusinessGroupNoName}
    Element Text Should Be    ${txtMessageBusinessGroupNoName}    ${txtBusinessGroupNoName}
    Capture ScreenShot

Edit Company Data
    edit name    Company
    sleep    3
    Edit company plant

Edit company plant
    click edit button    Company
    Delete List    Company
    click ddl    Plant

Verify Company Edit
    Wait Until Page Contains Element    ${lblCompanyNameFirstRow}
    Page Should Contain Element    ${lblCompanyNameFirstRow}
    sleep    2
    Capture ScreenShot

Verify Delete Company
    [Arguments]    ${name}
    Element Should Not Contain    ${lblCompanyNameFirstRow}    ${name}
    Capture ScreenShot

Edit Business Group Data
    edit name    BusinessGroup
    sleep    2
    Edit business group company

Edit business group company
    click edit button    Business Group
    click ddl    Company
    select ddl    Company    3    3

Verify Business Group Edit
    Wait Until Page Contains Element    ${lblBusinessGroupNameFirstRow}
    Page Should Contain Element    ${lblBusinessGroupNameFirstRow}
    sleep    2
    Capture ScreenShot

Verify Business Group Delete
    [Arguments]    ${name}
    Element Should Not Contain    ${lblBusinessGroupNameFirstRow}    ${name}
    Capture ScreenShot

Fill Plant Data With Multiple Machine
    Fill Code    Plant    ${txtPlantCode}
    Fill Name    Plant    ${txtPlantName}
    select multiple machine
    select location

select machine
    click ddl    Machine
    Select ddl    Machine    1    2

select location
    click ddl    Location
    Select ddl    Location    1    2

select multiple machine
    click ddl    Machine
    Select ddl    Machine    1    2

select multiple location
    click ddl    Location
    Select ddl    Location    1    2

Verify Plant With Multiple Machine
    Element Should Contain    ${btnDeleteBusinessFirstRow}    dasdaf

Click Update Plant
    click update button    Plant

Verify Massage Plant No Code
    Web Element Text Should Be    ${lblPlantCodeRequired}    ${txtPlantCodeRequired}
    Capture ScreenShot

Verify Plant With Multiple Location
    Element Should Contain    dasdadaw    dasd

Fill Plant Data No Code
    Fill Code    Plant    ${EMPTY}
    Fill Name    Plant    ${txtPlantName}
    select machine
    select location
    Click Update Button    Plant

Fill Plant Data No Name
    Fill Code    Plant    ${txtPlantCode}
    Fill Name    Plant    ${EMPTY}
    select machine
    select location
    Click Update Button    Plant

Verify Massage Plant No Name
    Web Element Text Should Be    ${lblPlantNameRequired}    ${txtPlantNameRequired}
    Capture ScreenShot

Fill Plant Data With Multiple Location
    Fill Code    Plant    ${txtPlantCode}
    Fill Name    Plant    ${txtPlantName}
    select machine
    select multiple location

Fill Plant Data With Multiple Machines And Locations
    Fill Code    Plant    ${txtPlantCode}
    Fill Name    Plant    ${txtPlantName}
    select multiple machine
    select multiple location
