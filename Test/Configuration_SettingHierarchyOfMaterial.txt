*** Settings ***
Resource          Resource/PageKeywords/SCGPeMRPCommon.txt
Resource          Resource/PageKeywords/Configuration_SettingHierarchyOfMaterial.txt

*** Test Cases ***
46_Add Material Tier 1
    [Tags]    success
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    SettingHierarchyOfMaterial
    Click Add Material Tier
    Select Tier    1
    ${name}    Fill Material Tier Name
    Verify Add Material Tier 1 Success    ${name}
    [Teardown]    Keywords For Teardown

47_Add Material Tier 2
    [Tags]    success
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    SettingHierarchyOfMaterial
    Click Add Material Tier
    Select Tier    2
    Select Parent Tier
    ${name}    Fill Material Tier Name
    Verify Add Material Tier 2 Success    ${name}
    [Teardown]    Keywords For Teardown

48_Add Material Tier 3
    [Tags]    success
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    SettingHierarchyOfMaterial
    Click Add Material Tier
    Select Tier    3
    Select Parent Tier
    ${name}    Fill Material Tier Name
    Verify Add Material Tier 3 Success    ${name}
    [Teardown]    Keywords For Teardown

49_Add Material Tier 4
    [Tags]    success
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    SettingHierarchyOfMaterial
    Click Add Material Tier
    Select Tier    4
    Select Parent Tier
    ${name}    Fill Material Tier Name
    Verify Add Material Tier 4 Success    ${name}
    [Teardown]    Keywords For Teardown

50_Add Material Tier 5
    [Tags]    success
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    SettingHierarchyOfMaterial
    Click Add Material Tier
    Select Tier    5
    Select Parent Tier
    ${name}    Fill Material Tier Name
    Verify Add Material Tier 5 Success    ${name}
    [Teardown]    Keywords For Teardown

51_Search Material Tier
    [Tags]    success
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    SettingHierarchyOfMaterial
    Search Tier Name
    Verify Search Success
    [Teardown]    Keywords For Teardown

52_Add Material Tier Not Select Tier
    [Tags]    fail
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    SettingHierarchyOfMaterial
    Click Add Material Tier
    Fill Material Tier Name
    Verify Add Material Tier No Tier
    [Teardown]    Keywords For Teardown

53_Add Material Tier Not Select Parent Tier
    [Tags]    fail
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    SettingHierarchyOfMaterial
    Click Add Material Tier
    Select Tier    2
    Fill Material Tier Name
    Verify Add Material Tier No Parent Tier
    [Teardown]    Keywords For Teardown

54_Add Material Tier No Name
    [Tags]    fail
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    SettingHierarchyOfMaterial
    Click Add Material Tier
    Select Tier    5
    Select Parent Tier
    Click save material tier
    Verify Add Material Tier No Name
    [Teardown]    Keywords For Teardown

55_Add Material Tier Not Select Tier, Parent Tier and Input Tier Name
    [Tags]    fail
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    SettingHierarchyOfMaterial
    Click Add Material Tier
    Click save material tier
    Verify Material Tier No Tier Parent And Name
    [Teardown]    Keywords For Teardown

56_Add Material Tier in case duplicate record
    [Tags]    fail
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    SettingHierarchyOfMaterial
    Click Add Material Tier
    Fill Duplicate Material Tier Data
    Verify Add Material Tier Duplicate
    [Teardown]    Keywords For Teardown

57_Edit Material Tier
    [Tags]    success
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    SettingHierarchyOfMaterial
    ${name}    Edit Material Tier First Row
    Verify Edit Material    ${name}
    [Teardown]    Keywords For Teardown

58_Delete Material Tier
    [Tags]    success
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    SettingHierarchyOfMaterial
    Delete Material Tier
    Verify Delete Material Tier
    [Teardown]    Keywords For Teardown

59_Add Material Attribute
    [Tags]    success
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    SettingHierarchyOfMaterial
    Click Add Material Attribute
    ${name}    Fill Material Attribute Name
    Verify Add Material Attribute Success    ${name}
    [Teardown]    Keywords For Teardown

60_Add Material Attribute in case name is empty
    [Tags]    fail
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    SettingHierarchyOfMaterial
    Click Add Material Attribute
    Fill Material Attribute No Name
    Verify Material Attribute No Name
    [Teardown]    Keywords For Teardown

61_Add Material Attribute in case duplicate record
    [Tags]    fail
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    SettingHierarchyOfMaterial
    Click Add Material Attribute
    Fill Duplicate Material Attribute Name
    Verify Duplicate Material Attribute
    [Teardown]    Keywords For Teardown

62_Edit Material Attribute
    [Tags]    success
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    SettingHierarchyOfMaterial
    Click Add Material Attribute
    ${name}    Edit Material Attribute
    Verify Edit Material Attribute    ${name}
    [Teardown]    Keywords For Teardown

63_Delete Material Attribute
    [Tags]    success
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Configuration
    Select Sub Menu    SettingHierarchyOfMaterial
    Click Add Material Attribute
    ${name}    Delete Material Attribute Last Row
    Verify Delete Material Attribute Success    ${name}
    [Teardown]    Keywords For Teardown

*** Keywords ***
Verify Add Material Tier 1 Success
    [Arguments]    ${tiername}
    Take A Screenshot
    Alert Should Be Present    ${txtAddMaterialTierSuccess}
    sleep    2
    ${count}    Get Matching Xpath Count    //*[@id="gridMaterialTier"]/table/tbody/tr/td[1]
    Scroll Web To Element    xpath=//*[@id="gridMaterialTier"]/table/tbody/tr[${count}]/td[1]
    Web Element Text Should Be    xpath=//*[@id="gridMaterialTier"]/table/tbody/tr[${count}]/td[1]    ${tiername}
    Capture ScreenShot

Verify Add Material Tier 2 Success
    [Arguments]    ${tiername}
    Take A Screenshot
    Alert Should Be Present    ${txtAddMaterialTierSuccess}
    ${count}    Get Matching Xpath Count    xpath=//*[@id="gridMaterialTier"]/table/tbody/tr/td[2]
    sleep    2
    : FOR    ${index}    IN RANGE    1    ${count}
    \    Scroll Web To Element    xpath=//*[@id="gridMaterialTier"]/table/tbody/tr[${index}]/td[2]
    \    ${name}    Get Web Text    xpath=//*[@id="gridMaterialTier"]/table/tbody/tr[${index}]/td[2]
    \    Run Keyword If    "${name}" == "${tiername}"    Exit For Loop
    Capture ScreenShot

Verify Add Material Tier 3 Success
    [Arguments]    ${tiername}
    Take A Screenshot
    Alert Should Be Present    ${txtAddMaterialTierSuccess}
    ${count}    Get Matching Xpath Count    xpath=//*[@id="gridMaterialTier"]/table/tbody/tr/td[2]
    sleep    2
    : FOR    ${index}    IN RANGE    1    ${count}
    \    Scroll Web To Element    xpath=//*[@id="gridMaterialTier"]/table/tbody/tr[${index}]/td[3]
    \    ${name}    Get Web Text    xpath=//*[@id="gridMaterialTier"]/table/tbody/tr[${index}]/td[3]
    \    Run Keyword If    "${name}" == "${tiername}"    Exit For Loop
    Capture ScreenShot

Verify Add Material Tier 4 Success
    [Arguments]    ${tiername}
    Take A Screenshot
    Alert Should Be Present    ${txtAddMaterialTierSuccess}
    ${count}    Get Matching Xpath Count    xpath=//*[@id="gridMaterialTier"]/table/tbody/tr/td[2]
    sleep    2
    : FOR    ${index}    IN RANGE    1    ${count}
    \    Scroll Web To Element    xpath=//*[@id="gridMaterialTier"]/table/tbody/tr[${index}]/td[4]
    \    ${name}    Get Web Text    xpath=//*[@id="gridMaterialTier"]/table/tbody/tr[${index}]/td[4]
    \    Run Keyword If    "${name}" == "${tiername}"    Exit For Loop
    Capture ScreenShot

Verify Add Material Tier 5 Success
    [Arguments]    ${tiername}
    Take A Screenshot
    Alert Should Be Present    ${txtAddMaterialTierSuccess}
    ${count}    Get Matching Xpath Count    xpath=//*[@id="gridMaterialTier"]/table/tbody/tr/td[2]
    sleep    2
    : FOR    ${index}    IN RANGE    1    ${count}
    \    Scroll Web To Element    xpath=//*[@id="gridMaterialTier"]/table/tbody/tr[${index}]/td[5]
    \    ${name}    Get Web Text    xpath=//*[@id="gridMaterialTier"]/table/tbody/tr[${index}]/td[5]
    \    Run Keyword If    "${name}" == "${tiername}"    Exit For Loop
    Capture ScreenShot

Search Tier Name
    Input Web Text    ${txtboxSearchMaterial}    ${txtSearchTest}
    Click Web Element    ${btnSearchMaterial}

Verify Search Success
    sleep    2
    : FOR    ${index}    IN RANGE    1    6
    \    ${name}    Get Web Text    xpath=//*[@id="gridMaterialTier"]/table/tbody/tr/td[${index}]
    \    Run Keyword If    "${name}" == "${txtSearchTest}"    Exit For Loop
    Capture ScreenShot

Verify Add Material Tier No Tier
    Take A Screenshot
    Alert Should Be Present    ${txtAlertMaterialNoTier}
    Sleep    1
    Take A Screenshot
    Alert Should Be Present    ${txtAlertMaterialNoParentTier}

Verify Add Material Tier No Parent Tier
    Take A Screenshot
    Alert Should Be Present    ${txtAlertMaterialNoParentTier}

Verify Add Material Tier No Name
    Take A Screenshot
    Alert Should Be Present    ${txtAlertMaterialNoName}

Verify Material Tier No Tier Parent And Name
    Take A Screenshot
    Alert Should Be Present    ${txtAlertMaterialNoTier}
    Sleep    1
    Take A Screenshot
    Alert Should Be Present    ${txtAlertMaterialNoParentTier}
    Sleep    1
    Take A Screenshot
    Alert Should Be Present    ${txtAlertMaterialNoName}

Verify Add Material Tier Duplicate
    Take A Screenshot
    Alert Should Be Present    ${txtAlertDuplicateMaterialTier}

Fill Duplicate Material Tier Data
    Select Tier    4
    Select Parent Tier
    Input Web Text    ${txtboxTierName}    MP
    Click save material tier

Edit Material Tier First Row
    Capture ScreenShot
    Click Edit Material Tier
    ${name}    Fill Material Tier Name
    [Return]    ${name}

Verify Edit Material
    [Arguments]    ${name}
    Take A Screenshot
    Alert Should Be Present    ${txtAddMaterialTierSuccess}
    sleep    1
    Web Element Text Should Be    xpath=//*[@id="gridMaterialTier"]/table/tbody/tr[1]/td[1]    ${name}
    Capture ScreenShot

Fill Material Attribute Name
    Click add attribute
    ${name}    Generate Random String    4    [UPPER]
    Input Web Text    ${txtboxMaterialAttributeName}    ${name}
    Click save material attribute
    [Return]    ${name}

Verify Add Material Attribute Success
    [Arguments]    ${Atname}
    Click Web Element    ${btnRefreshAttribute}
    Click Web Element    ${btnMaterialAttributeLastPage}
    sleep    3
    ${count}    Get Matching Xpath Count    xpath= //*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr/td[1]
    Mouse Over    xpath= //*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr[${count}]/td[1]
    Web Element Text Should Be    xpath=//*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr[${count}]/td[1]    ${Atname}
    Capture ScreenShot

Edit Material Attribute
    Click Web Element    ${btnMaterialAttributeLastPage}
    Set Selenium Speed    0.2
    ${name}    Generate Random String    4    [UPPER]
    ${check}    Get Matching Xpath Count    //*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr/td[1]
    Click Web Element    xpath=//*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr[${check}]/td[2]/a[1]
    Take A Screenshot
    Input Web Text    ${txtboxMaterialAttributeName}    ${name}
    Click Web Element    xpath=//*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr[${check}]/td[2]/a[1]
    [Return]    ${name}

Verify Edit Material Attribute
    [Arguments]    ${Atname}
    sleep    1
    ${count}    Get Matching Xpath Count    xpath=//*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr/td[1]
    sleep    2
    Web Element Text Should Be    xpath=//*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr[${count}]/td[1]    ${Atname}
    Capture ScreenShot

Fill Material Attribute No Name
    Click add attribute
    Click save material attribute

Verify Material Attribute No Name
    Web Element Text Should Be    ${lblMessageMaterialAttributeNoName}    ${txtMaterialAttributeNoName}
    Capture ScreenShot

Delete Material Attribute Last Row
    Click Web Element    ${btnMaterialAttributeLastPage}
    Set Selenium Speed    0.2
    ${Frecord}    Get Matching Xpath Count    xpath=//*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr/td[1]
    ${Text}    Get Web Text    xpath=//*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr[${Frecord}]/td[1]
    Click Web Element    xpath=//*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr[${Frecord}]/td[2]/a[2]
    Take A Screenshot
    Dismiss Alert    true
    sleep    1
    [Return]    ${Text}

Verify Delete Material Attribute Success
    [Arguments]    ${Atname}
    Click Web Element    ${btnMaterialAttributeLastPage}
    sleep    1
    ${count}    Get Matching Xpath Count    xpath=//*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr/td[1]
    Run Keyword If    "${count}" == "0"    Capture ScreenShot
    Run Keyword If    "${count}" == "0"    Click Web Element    xpath=//*[@id="gridMaterialAttribute"]/div[4]/a[2]
    ${countR}    Get Matching Xpath Count    xpath=//*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr/td[1]
    Element Should Not Contain    xpath=//*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr[${countR}]/td[1]    ${Atname}
    Capture ScreenShot

Delete Material Tier
    Take A Screenshot
    ${count}    Get Matching Xpath Count    //*[@id="gridMaterialTier"]/table/tbody/tr/td[6]/span/a
    Scroll Web To Element    xpath=//*[@id="gridMaterialTier"]/table/tbody/tr[${count}]/td[6]/span/a
    Click Web Element    xpath=//*[@id="gridMaterialTier"]/table/tbody/tr[${count}]/td[6]/span/a
    sleep    1
    Click Web Element    xpath=/html/body/div[7]/div[3]/div/button[3]

Verify Delete Material Tier
    Take A Screenshot
    Alert Should Be Present    Delete MaterialTier was successful.

Fill Duplicate Material Attribute Name
    Click Web Element    ${btnMaterialAttributeLastPage}
    ${Frecord}    Get Matching Xpath Count    //*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr/td[1]
    ${Text}    Get Web Text    xpath=//*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr[${Frecord}]/td[1]
    Click add attribute
    Input Web Text    ${txtboxMaterialAttributeName}    ${Text}
    Click save material attribute

Verify Duplicate Material Attribute
    Click Web Element    ${btnMaterialAttributeLastPage}
    ${count}    Get Matching Xpath Count    //*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr
    Scroll Web To Element    xpath=//*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr[${count}]/td[1]
    ${name1}    Get Web Text    xpath=//*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr[${count}]/td[1]
    Run Keyword If    "${count}" == "1"    verify duplicate attribute diff page
    Element Should Not Contain    xpath=//*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr[${count}-1]/td[1]    ${name1}
    Capture ScreenShot

verify duplicate attribute diff page
    Click Web Element    xpath=//*[@id="gridMaterialAttribute"]/div[4]/a[2]
    ${count1}    Get Matching Xpath Count    //*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr/td[1]
    ${name2}    Get Web Text    xpath=//*[@id="gridMaterialAttribute"]/div[3]/table/tbody/tr[${count}]/td[1]
    Capture ScreenShot
