*** Settings ***
Resource          Resource/PageKeywords/Inventory_OverallInventory.txt
Resource          Resource/PageKeywords/SCGPeMRPCommon.txt

*** Test Cases ***
80_Search overall inventory by all
    [Tags]    success
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Inventory
    Select Sub Menu    OverallInventory
    Search By All
    Verify Search By All
    [Teardown]    Keywords For Teardown

81_Search overall inventory by Business Group
    [Tags]    success
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Inventory
    Select Sub Menu    OverallInventory
    Search By Business Group
    Verify Search By Business Group
    [Teardown]    Keywords For Teardown

82_Search overall inventory by Business Group in case multiple search
    [Tags]    success
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Inventory
    Select Sub Menu    OverallInventory
    Search Multiple Business Group
    Verify Search Multiple Business Group
    [Teardown]    Keywords For Teardown

83_Search overall inventory by Company
    [Tags]    success
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Inventory
    Select Sub Menu    OverallInventory
    Search By Company
    Verify Search By Company
    [Teardown]    Keywords For Teardown

84_Search overall inventory by Company in case multiple search
    [Tags]    success
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Inventory
    Select Sub Menu    OverallInventory
    Search Multiple Company
    Verify Search Multiple Company
    [Teardown]    Keywords For Teardown

85_Search overall inventory by Plant
    [Tags]    success
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Inventory
    Select Sub Menu    OverallInventory
    Search By Plant
    Verify Search By Plant
    [Teardown]    Keywords For Teardown

86_Search overall inventory by Plant in case multiple search
    [Tags]    success
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Inventory
    Select Sub Menu    OverallInventory
    Search Multiple Plant
    Verify Search Multiple Plant
    [Teardown]    Keywords For Teardown

87_Search overall inventory in case empty
    [Tags]    success
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Inventory
    Select Sub Menu    OverallInventory
    Click search
    Verify Search Empty
    [Teardown]    Keywords For Teardown

88_Search overall inventory by Plant in case not information of yesterday date
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Inventory
    Select Sub Menu    OverallInventory
    [Teardown]    Keywords For Teardown

89_Verify the maximum number of main block (material tier 1) is 8 main blocks per plant.
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Inventory
    Select Sub Menu    OverallInventory
    Select plant    Over3
    Click search
    Verify Material Tier 1 Not More Than 8
    [Teardown]    Keywords For Teardown

90_Verify the maximum material tier 2 of main block is not more than 8 block
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Inventory
    Select Sub Menu    OverallInventory
    Select plant    Over1
    Click search
    Verify Material Tier 2 Not More Than 8
    [Teardown]    Keywords For Teardown

91_Verify the maximum Ton is xx,xxx Ton.
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Inventory
    Select Sub Menu    OverallInventory
    [Teardown]    Keywords For Teardown

92_Verify the oval graph shall display blue color for used space and grey color for free space
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Inventory
    Select Sub Menu    OverallInventory
    [Teardown]    Keywords For Teardown

93_Verify calculation of the oval graph
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Inventory
    Select Sub Menu    OverallInventory
    [Teardown]    Keywords For Teardown

94_Verify calculation of the raw material of Ton
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Inventory
    Select Sub Menu    OverallInventory
    [Teardown]    Keywords For Teardown

95_Verify status color of the raw material in case minimum
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Inventory
    Select Sub Menu    OverallInventory
    [Teardown]    Keywords For Teardown

96_Verify status color of the raw material in case warning
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Inventory
    Select Sub Menu    OverallInventory
    [Teardown]    Keywords For Teardown

97_Verify status color of the raw material in case maximum
    Open SCG Website
    Login SCGP    ${txtLoginUsername}    ${txtLoginPassword}
    Select Menu    Inventory
    Select Sub Menu    OverallInventory
    [Teardown]    Keywords For Teardown

*** Keywords ***
Search By All
    Select business group    OVER1
    sleep    1
    Select company    0001
    sleep    1
    Select Plant    Over1
    Click search

Verify Search By All
    Web Element Text Should Be    ${lblBlock1}    ${lblMaterialTier1Fib}
    sleep    2
    Capture ScreenShot

Search By Business Group
    Select business group    OVER1
    Click search

Verify Search By Business Group
    Web Element Text Should Be    ${lblBlock1}    ${lblMaterialTier1Fib}
    sleep    2
    Capture ScreenShot

Search Multiple Business Group
    Select business group    OVER1
    Select business group    OVER2
    Click search

Verify Search Multiple Business Group
    Web Element Text Should Be    ${lblBlock1}    ${lblMaterialTier1Fib}
    Web Element Text Should Be    ${lblBlock1}    ${lblMaterialTier1Over}
    sleep    2
    Capture ScreenShot

Search By Company
    Select company    0001
    Click search

Verify Search By Company
    Web Element Text Should Be    ${lblBlock1}    ${lblMaterialTier1Fib}
    sleep    2
    Capture ScreenShot

Search Multiple Company
    Select company    0001
    Select company    0002
    Click search

Verify Search Multiple Company
    Web Element Text Should Be    ${lblBlock1}    ${lblMaterialTier1Fib}
    sleep    2
    Capture ScreenShot

Search By Plant
    Select plant    Over1
    Click search

Verify Search By Plant
    Web Element Text Should Be    ${lblBlock1}    ${lblMaterialTier1Fib}
    sleep    2
    Capture ScreenShot

Search Multiple Plant
    Select plant    Over1
    Select plant    Over3
    Click search

Verify Search Multiple Plant
    Web Element Text Should Be    ${lblBlock1}    ${lblMaterialTier1Fib}
    sleep    2
    Capture ScreenShot

Verify Search Empty
    Web Element Text Should Be    ${lblBlock1}    ${lblMaterialTier1Fib}
    sleep    2
    Capture ScreenShot

Verify Material Tier 1 Not More Than 8
    ${count}    Get Matching Xpath Count     //*[@class="jarviswidget"]
    sleep    1
    Run Keyword If    ${count} < 9    Capture ScreenShot
    ...    ELSE    Fail

Verify Material Tier 2 Not More Than 8
    ${count}    Get Matching Xpath Count    //*[@id="block1"]//*[@class="row"]//*[@class="tier2"]
    sleep    1
    Run Keyword If    ${count} < 9    Capture ScreenShot
    ...    ELSE    Fail
